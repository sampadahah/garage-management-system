{% extends "customer_base.html" %}

{% block page_title %}Leaves{% endblock %}
{% block page_subtitle %}Manage staff/mechanic leave requests{% endblock %}

{% block content %}
<div class="content-wrapper">
    <div class="header-actions">
        <h3>Leave Applications</h3>
    </div>

    <div class="table-container">
        <table class="data-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Employee</th>
                    <th>Type</th>
                    <th>From</th>
                    <th>To</th>
                    <th>Status</th>
                    <th>Applied At</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for l in leaves %}
                <tr>
                    <td>#{{ l.leave_id }}</td>
                    <td>{{ l.user.get_full_name|default:l.user.username }}</td>
                    <td>{{ l.leave_type }}</td>
                    <td>{{ l.start_date|date:"M d, Y" }}</td>
                    <td>{{ l.end_date|date:"M d, Y" }}</td>
                    <td>
                        {% if l.status == "approved" %}
                            <span class="status-badge status-success">Approved</span>
                        {% elif l.status == "rejected" %}
                            <span class="status-badge status-danger">Rejected</span>
                        {% else %}
                            <span class="status-badge status-warning">Pending</span>
                        {% endif %}
                    </td>
                    <td>{{ l.applied_at|date:"M d, Y H:i" }}</td>
                    <td>
                        {% if l.status == "pending" %}
                        <div class="action-buttons">
                            <a class="btn btn-primary btn-sm" href="{% url 'adminpanel:decide_leave' l.leave_id 'approve' %}">
                                Approve
                            </a>
                            <a class="btn btn-danger btn-sm" href="{% url 'adminpanel:decide_leave' l.leave_id 'reject' %}">
                                Reject
                            </a>
                        </div>
                        {% else %}
                            -
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="8" class="text-center">No leave applications found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}